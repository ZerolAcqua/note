---
title: A combined image matching method for Chinese optical satellite imagery
---

# A combined image matching method for Chinese optical satellite imagery

针对中国光学卫星影像，本文提出一种影像匹配融合方法：

- 改进的 Wallis 型滤波器，自适应地确定参数，同时避免“过增强”现象
- 基于全局-局部策略的误匹配过程，消除尺度不变特征变换算法产生的异常值。并通过带有光束法区域网平差几何定向补偿位置姿态观测值系统误差
- 设计一个新的相似性测度（DANCC），能考虑几何与纹理相似性
- 引入分层匹配策略，逐层提高匹配精度

## 1 Introduction

目前的卫星影像匹配算法存在以下几个问题

- 卫星的 EOP 预先知道，许多匹配算法都使用核线约束。但是中国卫星影像的实时外方位元素误差较大，核线的预测精度低。差距很大时同名点与同名核线之间的误匹配情况会大幅增加。
- 不同平台和视角获取的卫星影像存在较大的局部几何畸变，使相关性下降，匹配算法失效
- 对困难的匹配情况，很难找到可靠的同名点，一些算法就无法使用了。

## 2 Related work

- 多视的最小二乘匹配
- NCC 中严格几何辐射假定
- 基于边缘和区域的混合立体匹配算法
- 基于匹配误差统计分布的松弛方案
- 几何约束的互相关 GC<sup>3</sup>
- SNCC 要求多幅图像
- 基于特征与区域的融合算法
  - SIFT→LSM→点云
  - 重复纹理和同质区域有问题
  - 没有利用 EOP 数据简化匹配
- 基于三角剖分的分层影像匹配算法
  - 核线约束对卫星影像来说并不合适（线阵卫星影像的核线不是原本意义上笔直的直线）
  - 近似核线
- 基于线的匹配方法

## 3 Algorithmic outline

- 改进的 Wallis 滤波器

  - Wallis 滤波器的问题
    - 不合理的参数造成过增强问题，可能使纹理信息丢失，抑噪失败
    - 参数不是自适应确定的
  - Ostu 方法获取优化的阈值

- 初始几何定向

  - 实时外方位元素误差较大，核线的预测精度低
  - 初始几何定向后计算近似核线

  - 模型主要有
    - the direct georeferencing model
    - the piecewise polynomial model
    - the orientation image model
    - the systematic error compensation model

  1. 基于全局-局部的误匹配检测
     - 二次多项式全局拟合
     - 左影像变换到右影像上
     - 偏差大于三倍中误差时剔除
     - 光束法区域网平差使用系统误差补偿模型提高精度，高程也可同时求出
     - 在同名点之间位置高程关系建立的邻域空间中，对同名点进行分类
     - 在局部区域应当是平滑的
     - 对每个小区域用 RANSAC 剔除异常值，用仿射变换作为局部的拟合模型
     - 光束法平差

- Combined image matching method

  - 初始三角网生成后，沿着相应的近似核线，对每个兴趣点生成一系列的相关窗口。鲁棒的近似核线是基于 SRTM 通过一种投影轨迹法生成的
  - 用一种综合的相似性测度找到正确的匹配点
  - 用一种新的分层匹配策略，获得可靠且准确的匹配结果

  1. 确定相关窗口

     在初始化几何方向之后，保存了一些鲁棒的同名点。用它们生成一对初始的 Delaunay 三角网。本文假设三个三角形都是一个局部的平面。

     相应的特征点，会落在相应的三角网内。少数的误匹配是由于差别不一致产生的，可通过异常值检测方法消除

  2. 局部几何变形校正

     不同分辨率、不同视角的卫星影像，地形起伏会引起局部畸变且形成不规则的窗口。使用仿射变换纠正窗口，纠正窗口后需要重采样。

     投影窗口足够小，可以认为深度是连续的。

  3. 一种综合性的相似性测度（DANCC）

     - 距离向量

       相应兴趣点到相应三角形最近的顶点的距离应相等。但实际中由于尺度与视角的原因，距离会不相等。（公式）

     - 角度向量

       角度相应的也应该一致，但同样由于地形起伏会有不同（公式）

     - 自适应的归一化互相关系数

       用相应的三角形顶点自适应计算阈值

     - 相似性测度建立

       最小欧氏距离，权重系数的估计，DANCC 具有辐射不变性

  4. 分层匹配策略

     逐层重提取兴趣点，并更新近似核线，用二次多项式拟合细化匹配结果。顶层影像匹配完成后，用光束法区域网平差补偿 EOPs，所有匹配点的残差都可以计算得到。用 3 倍中误差筛选下一层的匹配点，建立三角网，并用处理后的 EOPs 计算更精确的近似核线。在三角与核线约束下重新提取兴趣点。逐层重复过程，直至匹配点被细化，残差小于 6 倍中误差后作为最终匹配结果。


## 4 Experiments and analysis

## 5 Conclusions

- 本文中改进的 Wallis 型滤波器能避免过增强问题，参数可以自适应地确定。从而提高图像增强效果，提高匹配成功率

- 用 SIFT 算法得到初始匹配点后，引于基于全局-局部策略的误匹配检测，有效去除异常值。使用带光束法区域网平差的几何方位提高 EOPs 的准确性，能理想地减小搜索范围，增强匹配过程中的核线约束

- 提出了近似核线和三角网约束，以及综合的相似性测度（DANCC）。这种方法考虑了几何、纹理相似性，即使在低纹理或重复纹理的地区，也能有好的表现

- 引入了新的分层匹配策略，其中使用了光束法区域网平差，兴趣点逐层提取，近似核线和三角网逐层更新。直至二次多项式拟合模型适用在原始影像上于细化匹配点。这种分层匹配即使在 EOPs 有很大的误差的情况下，也能有好的匹配结果

实验结果表明，本文提出的方法能够对不同的中国卫星图像获得密集且均匀的匹配结果。即使在居民区、田地和山区中，区配结果也很稳定。与目前流行的两种方法相比，新方法对中国卫星影像的处理效果要更好。